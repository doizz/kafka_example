# 7장 카프카 운영과 모니터링

---
### 안정적인 운영을 위한 주키퍼와 카프카 구성

 - 주키퍼 구성
    - 카프카가 주키퍼의 의존성을 제거하려고 하고있지만 현재까지는 조합해서 사용하는경우가 대다수.

 - 주키퍼 서버 수량
   - 기본적으로 쿼럼(과반수) 구성을 기반으로 동작하며 반드시 홀수 구성이 적합 -최소3개-
 - 주키퍼 하드웨어
   - 주키퍼는 하드웨어적으로 높은 스펙을 필요로 하지 않는다.
   - 과도한 디스크를 장착하는것은 메모리를 낭비할수도 있다.
 - AWS와 같은 클라우드 환경에서 서버를 구성할경우는 가용 영역에 2개 또는 3개로 분산해서 구성을 추천함.

 - 카프카 구성
    - 카프카 서버 수량
        - 주키퍼와 차이점은 쿼럼 방식의 구성이 필요하지않아 홀수일 필요는 없다.
        - 주키퍼와 서버구성을 맞추기위해서 홀수구성을 하는것이 좋다.
    - 카프카는 서버 확장성이 있기때문에 미리 서버를 많이 구축할 필요가 없다.

 - 카프카 하드웨어
    - 주키퍼와 다른점은 카프카는 CPU사용률이 높다.
    - 코어수가 많은 CPU로 구성하는것이 좋다.
 - 카프카 배치도 가용영역에 분산하여 여러서버를 구성하는것을 권장한다.

---
### 모니터링 시스템 구성
- 현재의 상태를 모니터링하여 추후에 발생할 문제를 사전에 조치함.
- 카프카의 대표적인 모니터링 방법
  - 애플리케이션 로그분석
  - JMX를 이용한 브로커들의 메트릭 정보 확인


- JMX를 이용한 카프카 메트릭 모니터링
    - JMX는 자바로 만든 애플리케이션 모니터링 도구를 제공하는 자바 API
    - 가장 많이 쓰이는 프로메테우스와 익스포터로 구성된다.
